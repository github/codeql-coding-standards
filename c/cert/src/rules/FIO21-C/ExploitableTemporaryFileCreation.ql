/**
 * @id c/cert/exploitable-temporary-file-creation
 * @name FIO21-C: Do not create temporary files in shared directories
 * @description Temporary files can be hijacked or manipulated by an attacker if not created in a
 *              secure manner.
 * @kind problem
 * @precision very-high
 * @problem.severity error
 * @tags external/cert/id/fio21-c
 *       security
 *       external/cert/obligation/recommendation
 */

import cpp
import codingstandards.c.cert

from FunctionCall fc, string funcName
where
  not isExcluded(fc, IO5Package::exploitableTemporaryFileCreationQuery()) and
  funcName = fc.getTarget().getName() and
  funcName in ["tmpfile", "tmpfile_s", "tmpnam", "tmpnam_s", "mktemp"]
select fc, "Unsafe temporary file creation function '" + funcName + "' called."
